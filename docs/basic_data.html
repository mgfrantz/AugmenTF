---

title: Basic Data

keywords: fastai
sidebar: home_sidebar

summary: "This module is for basic datasets to be used by models."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_basic_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WARNING:tensorflow:Falling back to tensorflow client, its recommended to install the cloud tpu client directly with pip install cloud-tpu-client .
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make a dummy CSV dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>

<span class="n">N_CHUNKS</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">text_datapath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data/csv&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">text_datapath</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">text_datapath</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">CSV_PATH</span> <span class="o">=</span> <span class="n">text_datapath</span><span class="o">/</span><span class="s1">&#39;20_newsgroups.csv&#39;</span>

<span class="n">news</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">()</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">news</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">target</span>

<span class="n">textdata_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">labels</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
<span class="n">textdata_df</span><span class="p">[</span><span class="s1">&#39;label_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textdata_df</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">news</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="n">textdata_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dataset_from_df" class="doc_header"><code>make_dataset_from_df</code><a href="https://github.com/mgfrantz/AugmenTF/tree/master/AugmenTF/basic_data.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dataset_from_df</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Returns a tf.data.Dataset.</p>
<p>Options:</p>
<p>df: a pandas.DataFrame</p>
<p>Returns:</p>
<p>A tf.data.Dataset</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we'll load a tf.data.Dataset from a DataFrame.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">textdata_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>labels</th>
      <th>label_names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>From: lerxst@wam.umd.edu (where's my thing)\nS...</td>
      <td>7</td>
      <td>rec.autos</td>
    </tr>
    <tr>
      <th>1</th>
      <td>From: guykuo@carson.u.washington.edu (Guy Kuo)...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
    <tr>
      <th>2</th>
      <td>From: twillis@ec.ecn.purdue.edu (Thomas E Will...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
    <tr>
      <th>3</th>
      <td>From: jgreen@amber (Joe Green)\nSubject: Re: W...</td>
      <td>1</td>
      <td>comp.graphics</td>
    </tr>
    <tr>
      <th>4</th>
      <td>From: jcm@head-cfa.harvard.edu (Jonathan McDow...</td>
      <td>14</td>
      <td>sci.space</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">make_dataset_from_df</span><span class="p">(</span><span class="n">textdata_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;text&#39;, &#39;labels&#39;, &#39;label_names&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>b&#34;From: cramer@optilink.COM (Clayton Cramer)\nSubject: Re: New Study Out On Gay Percentage\nOrganization: Optilink Corporation, Petaluma, CA\nLines: 31\n\nIn article &lt;1993Apr16.164638.27218@galileo.cc.rochester.edu&gt;, as010b@uhura.cc.rochester.edu (Tree of Schnopia) writes:\n&gt; In &lt;15378@optilink.COM&gt; cramer@optilink.COM (Clayton Cramer) writes:\n# #The article also contains numbers on the number of sexual partners.\n# #The median number of sexual partners for all men 20-39 was 7.3.\n# #Compared to the table I have already posted from Masters, Johnson,\n# #and Kolodny showing male homosexual partners, it is apparent that\n# #homosexual men are dramatically more promiscuous than the general\n# #male population.  It&#39;s a shame that we don&#39;t have a breakdown for\n# #straight men vs. gay/bi men -- that would show even more dramatically\n# #how much more promiscuous gay/bi men are.\n# \n# Possibly because gay/bi men are less likely to get married?\n\nMarriage isn&#39;t a requirement for a couple staying together.\n\n# What was the purpose of this post?  If it was to show a mindless obsession\n# with statistics, an incredibly flawed system of reasoning, and a repellent\n# hatemonger agenda, then the purpose was accomplished with panache.\n# \n# (a) Get a clue.  (b) Get a life.  (c) Get out of my face.  I&#39;m not in yours.\n# \n# ----bi    Andrew D. Simchik\t\t\t\t\tSCHNOPIA!\n\nYes you are.  When you and the rest of the homosexual community\npass laws to impose your moral codes on me, by requiring me to\nhire, rent to, or otherwise associate with a homosexual against\nmy will, yes, you are in my face.  Until homosexuals stop trying\nto impose their morals on me, I will be in your face about this.\n-- \nClayton E. Cramer {uunet,pyramid}!optilink!cramer  My opinions, all mine!\nRelations between people to be by mutual consent, or not at all.\n&#34;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([18,  0], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dataset_from_csv" class="doc_header"><code>make_dataset_from_csv</code><a href="https://github.com/mgfrantz/AugmenTF/tree/master/AugmenTF/basic_data.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dataset_from_csv</code>(<strong><code>csv_path</code></strong>)</p>
</blockquote>
<p>Returns a tf.data.Dataset.</p>
<p>Options:</p>
<p>csv_path: str or Path of the CSV you want to load.</p>
<p>Returns:</p>
<p>A tf.data.Dataset</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we'll load a tf.data.Dataset from a CSV.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">make_dataset_from_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;text&#39;, &#39;labels&#39;, &#39;label_names&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([b&#34;From: tmc@spartan.ac.BrockU.CA (Tim Ciceran)\nSubject: Re: Hijaak\nOrganization: Brock University, St. Catharines Ontario\nX-Newsreader: TIN [version 1.1 PL9]\nLines: 15\n\nHaston, Donald Wayne (haston@utkvx.utk.edu) wrote:\n: Currently, I use a shareware program called Graphics Workshop.\n: What kinds of things will Hijaak do that these shareware programs\n: will not do?\n\nI also use Graphic Workshop and the only differences that I know of are that\nHijaak has screen capture capabilities and acn convert to/from a couple of\nmore file formats (don&#39;t know specifically which one).  In the April 13\nissue of PC Magazine they test the twelve best selling image capture/convert\nutilities, including Hijaak.\n\nTMC.\n(tmc@spartan.ac.brocku.ca)\n\n\n&#34;,
       b&#39;From: dpeterik@iastate.edu (Dan Peterik)\nSubject: Re: Brewer Notes\nOrganization: Iowa State University, Ames IA\nLines: 26\n\nIn &lt;30MAR93.02086551.0010@MUSIC.LIB.MATC.EDU&gt; PFAN &lt;PFAN@MUSIC.LIB.MATC.EDU&gt; writes:\n\n&gt;For those of you who know who Bernie Brewer is, he\&#39;s back.  The\n&gt;team mascot, if you will, was given his walking papers a few years\n&gt;ago, but the fans voted him back last season and he will be perched\n&gt;in the his familiar home in the outfield and will again slide down\n&gt;into a barrel of beer when home runs are hit.\n\nThat is great to hear I just may have to take a raod trip to Milwakee this year and see that again.  Last time I saw Bernie Brewer was at the age of 10 and I am now 21 thanks for this post.\n\n&gt;One final note, Bill Spiers is leading the Brewers with 13 RBI\&#39;s in\n&gt;exhibition play.  Looks like he\&#39;s bouncing back nicely from back\n&gt;problems.\n\nGood to Bill is getting better form the limited coverage we get here in Iowa\nI know that this will be a great season for the BREW CREW!!\n\n\n&gt;/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\\n&gt;| Pete Fanning, Computer Operator  | &#34;Leadership is ACTION |\n&gt;| Office of Information Technology |  ...NOT Position&#34;     |\n&gt;| Milwaukee Area Technical College |     -- D. H. McGannon |\n&gt;|**********************************************************|\n&gt;| Email: pfan@music.lib.matc.edu (Internet)                |\n&gt;|  -or-  Pete.Fanning@f71.n154.z1.fidonet.org              |\n&gt;\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\\/\n&#39;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 9], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

