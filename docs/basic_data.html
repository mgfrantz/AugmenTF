---

title: Basic Data

keywords: fastai
sidebar: home_sidebar

summary: "This module is for basic datasets to be used by models."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_basic_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make a dummy CSV dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>

<span class="n">N_CHUNKS</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">text_datapath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data/csv&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">text_datapath</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">text_datapath</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">CSV_PATH</span> <span class="o">=</span> <span class="n">text_datapath</span><span class="o">/</span><span class="s1">&#39;20_newsgroups.csv&#39;</span>

<span class="n">news</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">()</span>

<span class="n">texts</span> <span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">data</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">target</span>

<span class="n">textdata_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">labels</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
<span class="n">textdata_df</span><span class="p">[</span><span class="s1">&#39;label_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textdata_df</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">news</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="n">textdata_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dataset_from_df" class="doc_header"><code>make_dataset_from_df</code><a href="https://github.com/mgfrantz/AugmenTF/tree/master/AugmenTF/basic_data.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dataset_from_df</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Returns a tf.data.Dataset.</p>
<p>Options:</p>
<p>df: a pandas.DataFrame</p>
<p>Returns:</p>
<p>A tf.data.Dataset</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we'll load a tf.data.Dataset from a DataFrame.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">textdata_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>labels</th>
      <th>label_names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>From: lerxst@wam.umd.edu (where's my thing)\nS...</td>
      <td>7</td>
      <td>rec.autos</td>
    </tr>
    <tr>
      <th>1</th>
      <td>From: guykuo@carson.u.washington.edu (Guy Kuo)...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
    <tr>
      <th>2</th>
      <td>From: twillis@ec.ecn.purdue.edu (Thomas E Will...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
    <tr>
      <th>3</th>
      <td>From: jgreen@amber (Joe Green)\nSubject: Re: W...</td>
      <td>1</td>
      <td>comp.graphics</td>
    </tr>
    <tr>
      <th>4</th>
      <td>From: jcm@head-cfa.harvard.edu (Jonathan McDow...</td>
      <td>14</td>
      <td>sci.space</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">make_dataset_from_df</span><span class="p">(</span><span class="n">textdata_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;text&#39;, &#39;labels&#39;, &#39;label_names&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([b&#39;From: brian@meaddata.com (Brian Curran)\nSubject: Re: I\&#39;ve found the secret!\nOrganization: Mead Data Central, Dayton OH\nLines: 19\nDistribution: world\nNNTP-Posting-Host: taurus.meaddata.com\n\nIn article &lt;1993Apr15.161730.9903@cs.cornell.edu&gt;, tedward@cs.cornell.edu (Edward [Ted] Fischer) writes:\n|&gt; \n|&gt; Why are the Red Sox in first place?  Eight games into the season, they\n|&gt; already have two wins each from Clemens and Viola.  Clemens starts\n|&gt; again tonight, on three days rest.\n\nHuh?  Clemens pitched last on Saturday, giving him his usual four days\nrest.  \n\n|&gt; What\&#39;s up?  Are the Sox going with a four-man rotation?  Is this why\n|&gt; Hesketh was used in relief last night?\n-- \n------------------------------------------------------------------------------\nBrian Curran                 Mead Data Central              brian@meaddata.com \n------------------------------------------------------------------------------\n            &#34;I didn\&#39;t think I should\&#39;ve been asked to catch\n                 when the temperature was below my age.&#34;\n               - Carlton Fisk, Chicago White Sox catcher, \n              on playing during a 40-degree April ball game\n&#39;,
       b&#39;From: dchhabra@stpl.ists.ca (Deepak Chhabra)\nSubject: Re: Goalie masks\nNntp-Posting-Host: stpl.ists.ca\nOrganization: Solar Terresterial Physics Laboratory, ISTS\nLines: 21\n\nIn article &lt;120666@netnews.upenn.edu&gt; kkeller@mail.sas.upenn.edu (Keith Keller) writes:\n&gt;My vote goes to John Vanbiesbrouck.  His mask has a skyline of New York\n&gt;City, and on the sides there are a bunch of bees (Beezer).  It looks\n&gt;really sharp.\n\nFunny you should mention this; one time on HNIC Don Cherry pointed out\nVanbiesbrouck\&#39;s mask.  He _hated_ it.  I think he said something to the effect\nof:\n&#34;You see?  He was great last year; now he goes out and gets that dopey mask \nand he can\&#39;t stop a beachball!&#34;\n\nYou may or may not take Cherry seriously at all, but I cracked up when I heard\nit.\n\nI think Ed Belfour has the current best mask in the NHL btw.  I also like\nMoog\&#39;s, and I\&#39;ll give Fuhr\&#39;s new one an honourable mention, although I haven\&#39;t\nseen it closely yet (it looked good from a distance!).  What\&#39;s also neat is\nChevaldae\&#39;s in Detroit; they call him &#34;Chevy&#34; so he has two checkered flags\npainted at the top as in an auto race.\n\n\n&#39;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 9, 10], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dataset_from_csv" class="doc_header"><code>make_dataset_from_csv</code><a href="https://github.com/mgfrantz/AugmenTF/tree/master/AugmenTF/basic_data.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dataset_from_csv</code>(<strong><code>csv_path</code></strong>)</p>
</blockquote>
<p>Returns a tf.data.Dataset.</p>
<p>Options:</p>
<p>csv_path: str or Path of the CSV you want to load.</p>
<p>Returns:</p>
<p>A tf.data.Dataset</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we'll load a tf.data.Dataset from a CSV.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">make_dataset_from_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;text&#39;, &#39;labels&#39;, &#39;label_names&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([b&#34;From: wil@shell.portal.com (Ville V Walveranta)\nSubject: Re: Fall Comdex &#39;93\nNntp-Posting-Host: jobe\nOrganization: Portal Communications Company\nX-Newsreader: TIN [version 1.1 PL8]\nLines: 20\n\nDLS128@psuvm.psu.edu wrote:\n: Does anyone out there have any info on the up and coming fall comdex &#39;93? I was\n: asked by one of my peers to get any info that might be available.  Or, could\n: anyone point me in the right direction?  Any help would be appreciated.\n\n\tIt&#39;s in Las Vegas (as always) between November 16th and 20th.\n \n\tFor more information contact: The Interface Group\n\t\t\t\t      300 First Avenue\n\t\t\t\t      Needham, MA  02194-2722\n\n\tSorry, no phone number available. Consult directory service\n\tin Massachusetts for the number (617, 508 or 413).\n\n\t-- Willy\n--\n   *    Ville V. Walveranta      Tel./Fax....: (510) 420-0729     ****\n   **   96 Linda Ave., Apt. #5   From Finland: 990-1-510-420-0729  ***\n   ***  Oakland, CA  94611-4838  (FAXes automatically recognized)   **\n   **** USA                      Email.......: wil@shell.portal.com  *\n&#34;,
       b&#34;From: nicho@vnet.IBM.COM (Greg Stewart-Nicholls)\nSubject: Re: Biosphere II\nReply-To: nicho@vnet.ibm.com\nDisclaimer: This posting represents the poster&#39;s views, not those of IBM\nNews-Software: UReply 3.1\nX-X-From: nicho@vnet.ibm.com\n            &lt;1q1kia$gg8@access.digex.net&gt;\nLines: 18\n\nIn &lt;1q1kia$gg8@access.digex.net&gt; Pat writes:\n&gt;In article &lt;19930408.043740.516@almaden.ibm.com&gt; nicho@vnet.ibm.com writes:\n&gt;&gt;In &lt;1q09ud$ji0@access.digex.net&gt; Pat writes:\n&gt;&gt;&gt;Why is everyone being so critical of B2?\n&gt;&gt; Because it&#39;s bogus science, promoted as &#39;real&#39; science.\n&gt;It seems to me, that it&#39;s sorta a large engineering project more\n&gt;then a science project.\n  Bingo.\n&gt;B2 is not bench science,  but rather a large scale attempt to\n&gt;re-create a series of micro-ecologies.   what&#39;s so eveil about this?\n Nothing evil at all. There&#39;s no actual harm in what they&#39;re doing, only\nhow they represent it.\n\n -----------------------------------------------------------------\n .sig files are like strings ... every yo-yo&#39;s got one.\n\nGreg Nicholls ... nicho@vnet.ibm.com (business) or\n                  nicho@olympus.demon.co.uk (private)\n&#34;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 2, 14], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

