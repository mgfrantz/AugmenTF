---

title: Basic Data

keywords: fastai
sidebar: home_sidebar

summary: "This module is for basic datasets to be used by models."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01_basic_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WARNING:tensorflow:Falling back to tensorflow client, its recommended to install the cloud tpu client directly with pip install cloud-tpu-client .
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make a dummy CSV dataset</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>

<span class="n">N_CHUNKS</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">text_datapath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;data/csv&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">text_datapath</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">text_datapath</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">CSV_PATH</span> <span class="o">=</span> <span class="n">text_datapath</span><span class="o">/</span><span class="s1">&#39;20_newsgroups.csv&#39;</span>

<span class="n">news</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">()</span>

<span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">news</span><span class="o">.</span><span class="n">data</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">news</span><span class="o">.</span><span class="n">target</span>

<span class="n">textdata_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="n">labels</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">,</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
<span class="n">textdata_df</span><span class="p">[</span><span class="s1">&#39;label_names&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">textdata_df</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">news</span><span class="o">.</span><span class="n">target_names</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>

<span class="n">textdata_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dataset_from_df" class="doc_header"><code>make_dataset_from_df</code><a href="https://github.com/mgfrantz/AugmenTF/tree/master/AugmenTF/basic_data.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dataset_from_df</code>(<strong><code>df</code></strong>)</p>
</blockquote>
<p>Returns a tf.data.Dataset.</p>
<p>Options:</p>
<p>df: a pandas.DataFrame</p>
<p>Returns:</p>
<p>A tf.data.Dataset</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we'll load a tf.data.Dataset from a DataFrame.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">textdata_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>labels</th>
      <th>label_names</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>From: lerxst@wam.umd.edu (where's my thing)\nS...</td>
      <td>7</td>
      <td>rec.autos</td>
    </tr>
    <tr>
      <th>1</th>
      <td>From: guykuo@carson.u.washington.edu (Guy Kuo)...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
    <tr>
      <th>2</th>
      <td>From: twillis@ec.ecn.purdue.edu (Thomas E Will...</td>
      <td>4</td>
      <td>comp.sys.mac.hardware</td>
    </tr>
    <tr>
      <th>3</th>
      <td>From: jgreen@amber (Joe Green)\nSubject: Re: W...</td>
      <td>1</td>
      <td>comp.graphics</td>
    </tr>
    <tr>
      <th>4</th>
      <td>From: jcm@head-cfa.harvard.edu (Jonathan McDow...</td>
      <td>14</td>
      <td>sci.space</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">make_dataset_from_df</span><span class="p">(</span><span class="n">textdata_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;text&#39;, &#39;labels&#39;, &#39;label_names&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>b&#39;From: adam@endor.uucp (Adam Shostack)\nSubject: Re: Fundamentalism - again.\nOrganization: Aiken Computation Lab, Harvard University\nLines: 19\n\nIn article &lt;khan0095.734814178@nova&gt; khan0095@nova.gmi.edu (Mohammad Razi Khan) writes:\n&gt;One of my biggest complaints about using the word &#34;fundamentalist&#34;\n&gt;is that (at least in the U.S.A.) people speak of muslime\n&gt;fundamentalists                                  ^^^^^^^muslim\n&gt;but nobody defines what a jewish or christan fundamentalist is.\n&gt;I wonder what an equal definition would be..\n&gt;any takers..\n\n\tThe American press routinely uses the word fundamentalist to\nrefer to both Christians and Jews.  Christian fundementalists are\noften refered to in the context of anti-abortion protests.  The\nAmerican media also uses fundamentalist to refer to Jews who live in\nJudea, Samaria or Gaza, and to any Jew who follows the torah.\n\nAdam\nAdam Shostack \t\t\t\t       adam@das.harvard.edu\n\n&#34;If we had a budget big enough for drugs and sexual favors, we sure\nwouldn\&#39;t waste them on members of Congress...&#34;   -John Perry Barlow\n&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([17,  1], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_dataset_from_csv" class="doc_header"><code>make_dataset_from_csv</code><a href="https://github.com/mgfrantz/AugmenTF/tree/master/AugmenTF/basic_data.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_dataset_from_csv</code>(<strong><code>csv_path</code></strong>)</p>
</blockquote>
<p>Returns a tf.data.Dataset.</p>
<p>Options:</p>
<p>csv_path: str or Path of the CSV you want to load.</p>
<p>Returns:</p>
<p>A tf.data.Dataset</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here, we'll load a tf.data.Dataset from a CSV.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">make_dataset_from_csv</span><span class="p">(</span><span class="n">CSV_PATH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">break</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;text&#39;, &#39;labels&#39;, &#39;label_names&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([b&#39;From: geb@cs.pitt.edu (Gordon Banks)\nSubject: Re: My New Diet --&gt; IT WORKS GREAT !!!!\nReply-To: geb@cs.pitt.edu (Gordon Banks)\nOrganization: Univ. of Pittsburgh Computer Science\nLines: 35\n\nIn article &lt;1993Apr22.001642.9186@omen.UUCP&gt; caf@omen.UUCP (Chuck Forsberg WA7KGX) writes:\n\n&gt;&gt;&gt;&gt;Can you provide a reference to substantiate that gaining back\n&gt;&gt;&gt;&gt;the lost weight does not constitute &#34;weight rebound&#34; until it\n&gt;&gt;&gt;&gt;exceeds the starting weight?  Or is this oral tradition that\n&gt;&gt;&gt;&gt;is shared only among you obesity researchers?\n&gt;&gt;&gt;\n&gt;&gt;&gt;Annals of NY Acad. Sci. 1987\n&gt;&gt;&gt;\n&gt;&gt;Hmmm. These don\&#39;t look like references to me. Is passive-aggressive\n&gt;&gt;behavior associated with weight rebound? :-)\n&gt;\n&gt;I purposefully left off the page numbers to encourage the reader to\n&gt;study the volumes mentioned, and benefit therefrom.\n&gt;\n\nGood story, Chuck, but it won\&#39;t wash.  I have read the NY Acad Sci\none (and have it).  This AM I couldn\&#39;t find any reference to\n&#34;weight rebound&#34;.  I\&#39;m not saying it isn\&#39;t there, but since you\ncited it, it is your responsibility to show me where it is in there.\nThere is no index.  I suspect you overstepped your knowledge base,\nas usual.\n\n\n\n\n\n\n\n\n-- \n----------------------------------------------------------------------------\nGordon Banks  N3JXP      | &#34;Skepticism is the chastity of the intellect, and\ngeb@cadre.dsl.pitt.edu   |  it is shameful to surrender it too soon.&#34; \n----------------------------------------------------------------------------\n&#39;,
       b&#34;From: jiml@strauss.FtCollinsCO.NCR.COM (Jim L)\nSubject: Need Sharp 6220, T2000 parts, information\nDistribution: world\nOrganization: NCR Microelectronics Products Division (an AT&amp;T Company)\nLines: 23\n\nI&#39;m looking for a Sharp 6220 or TI Travelmate 2000 for parts.  Mine has\na bad RAM chip on the motherboard and I want to see what I can get for\nparts before sending it off to Sharp for repairs.  If you have one,\ndrop me a line.\n\nAlso, I&#39;m trying to set one up for a friend who needs to read his old\n5 1/4 inch diskettes.  Anyone have the pinout of the diskette expansion\nconnector on the back of the 3.5 inch floppy box? \n\nIf you respond, please include a phone number. I can&#39;t always get through \nwith email.\n \nAs always, \n\nThanks,\n\nJim Lewczyk\n\n-- \nMailer address is buggy!  Reply to: jiml@strauss.FtCollinsCO.NCR.com\n\nJames Lewczyk                                   1-303-223-5100 x9267\nNCR-MPD Fort Collins, CO             jim.lewczyk@FtCollinsCO.NCR.COM\n&#34;],
      dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([13,  6], dtype=int32)</pre>
</div>

</div>

</div>
</div>

</div>
</div>
 

